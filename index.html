<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>La roue de la servitude</title>
  
<!-- Favicons (nouveaux fichiers dans le dossier /icons) -->
<link rel="icon" href="/larouedelaservitude/icons/favicon.ico" type="image/x-icon">

<!-- Apple Touch Icons -->
<link rel="apple-touch-icon" sizes="180x180" href="/larouedelaservitude/icons/apple-touch-icon.png">

<!-- Ic√¥nes pour PWA (Progressive Web Apps) -->
<link rel="icon" type="image/png" sizes="192x192" href="/larouedelaservitude/icons/icon-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/larouedelaservitude/icons/icon-512x512.png">

<!-- Apple PWA support -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="La roue de la servitude">

<!-- Manifest PWA -->
<link rel="manifest" href="/larouedelaservitude/site.webmanifest">

<!-- Meta pour les r√©seaux sociaux (Open Graph / Twitter) -->
<meta property="og:image" content="/larouedelaservitude/icons/op-image.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/larouedelaservitude/icons/op-image.png">

<!-- html2canvas pour la capture -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<link rel="stylesheet" href="/larouedelaservitude/bills.css">

<style>
:root{
  --bg:#f7f7f7; --fg:#111; --ring:#e5e7eb;
  --emoji-size:80px; --bg-size:200vw;
}
  
/* 1Ô∏è‚É£ Tout h√©rite de la police principale */
*, *::before, *::after {
  font-family: inherit;
}

/* 2Ô∏è‚É£ Police syst√®me + lissage */
html,body {
  height: 100%;
  margin: 0;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: var(--bg);
  color: var(--fg);
}

body::before,body::after{
  content:"";position:fixed;z-index:0;width:var(--bg-size);height:var(--bg-size);
  top:calc(50% - var(--bg-size)/2);left:calc(50% - var(--bg-size)/2);
  pointer-events:none;
  background-image:url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' width='160' height='160' viewBox='0 0 160 160'>\
<text x='40' y='40' font-size='50'>‚ò≠</text>\
<text x='120' y='120' font-size='50'>‚ò≠</text>\
</svg>");
  background-repeat:repeat;background-size:var(--emoji-size) var(--emoji-size);
}
body::after{background-position:calc(var(--emoji-size)/2) calc(var(--emoji-size)/2);}

.wrap{position:relative;z-index:1;min-height:100vh;display:flex;flex-direction:column;align-items:center;
padding-top:clamp(24px,6vh,80px);padding-bottom:24px;box-sizing:border-box;}
.container{width:100%;max-width:720px;padding-inline:12px;display:grid;gap:12px;justify-items:center;}
h1{margin:0;font-size:clamp(18px,2.6vw,22px);font-weight:700;text-transform:uppercase;text-align:center;}
h1 .highlight{background:#c00;color:#fff;padding:4px 10px;border-radius:6px;}
.board{background:#fff;border:1px solid var(--ring);border-radius:12px;padding:8px;display:grid;gap:8px;justify-items:center;max-width:560px;box-sizing:border-box;}
.wheel-area{position:relative;width:100%;display:grid;place-items:center;}
.pointer{position:absolute;top:0;left:50%;transform:translateX(-50%);width:0;height:0;z-index:6;
--w:14px;--h:22px;border-left:var(--w) solid transparent;border-right:var(--w) solid transparent;border-top:var(--h) solid #111;}
canvas{width:clamp(250px,80vw,540px);aspect-ratio:1/1;display:block;border-radius:50%;background:#fafafa;box-shadow:inset 0 0 0 5px #f0f0f0;}
.controls{display:flex;gap:8px;align-items:center;justify-content:center;flex-wrap:wrap;}
button.primary{background:#111;color:#fff;border:none;border-radius:8px;padding:8px 12px;font-size:13px;font-weight:700;cursor:pointer;}
.legend{font-size:12px;color:#666;}
.overlay{position:fixed;top:0;left:0;right:0;bottom:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.35);z-index:9999;}
.bubble{position:relative;max-width:92%;padding:20px 48px 20px 20px;border-radius:14px;background:#111;color:#fff;
box-shadow:0 8px 24px rgba(0,0,0,0.25);font-size:clamp(14px,2.4vw,20px);font-weight:600;text-align:center;line-height:1.35;}
.close{position:absolute;top:10px;right:10px;width:34px;height:34px;border-radius:50%;border:none;background:rgba(255,255,255,0.12);color:#fff;
display:flex;align-items:center;justify-content:center;cursor:pointer;}
.close:hover{background:rgba(255,255,255,0.22);}
.share-bar{margin-top:14px;display:flex;gap:8px;flex-wrap:wrap;justify-content:center;position:relative;}
.share-btn{width:36px;height:36px;border-radius:50%;border:none;background:#fff;color:#111;font-size:18px;cursor:pointer;position:relative;}
.share-btn[title]:hover::after{content:attr(title);position:absolute;bottom:-28px;left:50%;transform:translateX(-50%);background:#111;color:#fff;padding:4px 8px;border-radius:6px;font-size:12px;white-space:nowrap;}
/* Ajustement du cadre de r√©sultat sur mobile */
@media (max-width: 600px) {
  .overlay {
    display: flex;
    align-items: center;
    justify-content: center;
    padding-top: 0;
  }
  .bubble {
    max-width: 90%;
    max-width: 340px;
    padding: 16px 36px 16px 16px;
    font-size: 15px;
    border-radius: 16px;
    margin: 0 auto;
    box-sizing: border-box;
  }
}
  /* Emp√™che l'affichage initial de la fen√™tre de r√©sultat */
.overlay[aria-hidden="true"] {
  display: none !important;
}

  /* Boutons de retour utilisateur */
.feedback-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
  margin-top: 14px;
}

.feedback-btn {
  background: #c00;
  color: #fff;
  padding: 10px 14px;
  border-radius: 8px;
  font-size: 15px;
  text-decoration: none;
  font-weight: 500;
  transition: background 0.2s ease, transform 0.15s ease;
}

.feedback-btn:hover {
  background: #900;
  transform: scale(1.05);
}

.feedback-btn:active {
  transform: scale(0.97);
}

/* Emp√™che le d√©filement de la page sur mobile */
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  overscroll-behavior: contain; /* bloque l'effet "rebond" sur mobile */
  touch-action: none; /* emp√™che le scroll tactile */
}

/* Emp√™che un fond plus grand que l‚Äô√©cran */
body {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
}

</style>
</head>
<body>
<div class="wrap">
  <div class="container">
    <h1><span class="highlight">La roue de la servitude</span></h1>
    <div class="board">
      <div class="wheel-area" id="wheelArea">
        <div class="pointer"></div>
        <canvas id="wheel" width="800" height="800"></canvas>
      </div>
      <div class="controls">
        <button id="spinBtn" class="primary">Tourner la roue</button>
        <div class="legend" id="countInfo"></div>
      </div>
    </div>
  </div>
</div>

<div id="overlay" class="overlay" aria-hidden="true">
  <div class="bubble" role="dialog" aria-modal="true">
    <div id="overlayText"></div>
    <div class="share-bar" id="shareBar">
      <button class="share-btn" data-platform="facebook" title="Partager sur Facebook">üìò</button>
      <button class="share-btn" data-platform="x" title="Partager sur X / Twitter">üê¶</button>
      <button class="share-btn" data-platform="instagram" title="Partager sur Instagram">üì∏</button>
      <button class="share-btn" data-platform="linkedin" title="Partager sur LinkedIn">üíº</button>
      <button class="share-btn" data-platform="snapchat" title="Partager sur Snapchat">üëª</button>
      <button class="share-btn" data-platform="tiktok" title="Partager sur TikTok">üéµ</button>
      <button class="share-btn" data-platform="whatsapp" title="Partager sur WhatsApp">üí¨</button>
      <button class="share-btn" data-platform="telegram" title="Partager sur Telegram">üì®</button>
      <button class="share-btn" id="copyText" title="Copier le texte">üìã</button>
    </div>
    <button id="overlayClose" class="close" aria-label="Fermer">‚úï</button>
  </div>
</div>

<!-- Modal feedback (placer dans body) -->
<button id="openFeedbackForm" class="feedback-btn" style="display:none">Donner un compl√©ment d'information</button>

<div id="feedbackModal" style="display:none;position:fixed;inset:0;z-index:12000;align-items:center;justify-content:center;background:rgba(0,0,0,0.45);">
  <form id="feedbackForm" style="background:#fff;padding:18px;border-radius:10px;max-width:520px;width:92%;box-sizing:border-box;">
    <h3>Donner un compl√©ment d'information</h3>
    <input type="hidden" id="formResult" name="resultText" value="">
    <input type="text" name="honeypot" id="honeypot" style="display:none" autocomplete="off">
    <label style="display:block;margin-top:8px;">
      Votre message
      <textarea id="formMessage" name="userMessage" required style="width:100%;height:120px"></textarea>
    </label>
    <label style="display:block;margin-top:8px;">
      Votre email (optionnel)
      <input id="formEmail" name="userEmail" type="email" style="width:100%">
    </label>
    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px;">
      <button type="button" id="closeFeedback">Annuler</button>
      <button type="submit">Envoyer</button>
    </div>
    <div id="feedbackStatus" style="margin-top:10px;font-size:13px;color:#333;display:none;"></div>
  </form>
</div>


  
<script>
/* =======================
   RESSOURCES / CONFIG
   ======================= */
let ENTRIES = ["Droits agricoles Recette : 179,7 millions d'euros Date de cr√©ation : 1962", "Droits de douane Recette : 1605,3 millions d'euros Date de cr√©ation : 1970", "Taxe √† la production sur le quota de sucre, le quota d'isoglucose et le quota de sirop d'inuline Recette : 306,4 millions d'euros Date de cr√©ation : 1970", "Cotisation assise sur le montant total des honoraires factur√©s par les commissaires aux comptes lorsqu'ils certifient les comptes ou les informations en mati√®re de durabilit√©    Date de cr√©ation : 2017", "Participation des employeurs √† l'effort de construction¬†(TPS-PEEC)    Date de cr√©ation : 1943", "Cotisation HLM et SEM", "Cotisation vers√©e par les organismes HLM et les SEM", "Cotisation additionnelle vers√©e par les organismes HLM et les SEM", "Redevance pour la r√©mun√©ration pour copie priv√©e Recette : 197 millions d'euros Date de cr√©ation : 1985", "Taxe de protection des obtentions v√©g√©tales Recette : 1 millions d'euros Date de cr√©ation : 1970", "Redevance per√ßue sur formalit√©s de l'Institut national de la propri√©t√© industrielle", "Contribution sur les abondements des employeurs aux plans d'√©pargne pour la retraite collectifs Recette : 5,3 millions d'euros Date de cr√©ation : 2001", "Contribution sur les avantages de pr√©retraite d'entreprise", "Contribution sur les r√©gimes de retraite conditionnant la constitution de droits √† prestations √† l'ach√®vement de la carri√®re du b√©n√©ficiaire dans l'entreprise", "Contribution sur les indemnit√©s de mise √† la retraite Recette : 39 millions d'euros Date de cr√©ation : 2007", "Contributions patronales et salariales sur les attributions d'options (stock-options) de souscription ou d'achat des actions et sur les attributions gratuites", "Forfait social", "Contribution salariale sur les carried-interests Recette : 2 millions d'euros Date de cr√©ation : 2010", "Contribution vente en gros Recette : 265 millions d'euros Date de cr√©ation : 1991", "contributions taux ¬´¬†Lv/Lh¬†¬ª    Date de cr√©ation : 1999", "Contribution sur les d√©penses de promotion des m√©dicaments Recette : 25 millions d'euros Date de cr√©ation : 2005", "contribution sur le chiffre d'affaires", "Cotisation sp√©ciale sur les boissons alcooliques Recette : 700 millions d'euros Date de cr√©ation : 1983", "Droits de plaidoirie Recette : 9,8 millions d'euros Date de cr√©ation : 1921", "Cotisations des employeurs au FNAL", "Fraction de Taxe de solidarit√© additionnelle", "Contribution sociale de solidarit√© des soci√©t√©s¬†(C3S)    Date de cr√©ation : 1992", "Droit d√©partemental de passage sur les ouvrages d'art reliant le continent aux √Æles maritimes Recette : 1 millions d'euros Date de cr√©ation : 1995", "Contribution additionnelle de solidarit√© pour l'autonomie¬†(CASA)    Date de cr√©ation : 2013", "Contribution √† la vie √©tudiante et de campus    Date de cr√©ation : 2018", "Redevance proportionnelle sur l'√©nergie hydraulique Recette : 0,9 millions d'euros Date de cr√©ation : 1919", "Droit de visa de r√©gularisation, taxe de renouvellement du titre de s√©jour, taxe applicable aux documents de circulation pour √©trangers mineurs et taxe per√ßue √† l'occasion de la d√©livrance du premier titre de s√©jour", "Contribution forfaitaire repr√©sentative des frais de r√©acheminement", "Redevance per√ßue √† l'occasion de l'introduction des familles √©trang√®res en France", "Redevance pour pollution de l'eau d'origine non domestique Recette : 107 millions d'euros Date de cr√©ation : 2006", "Redevances pour pollutions diffuses Recette : 107 millions d'euros Date de cr√©ation : 1964", "Redevance pour stockage d'eau en p√©riode d'√©tiage Recette : 1,3 millions d'euros Date de cr√©ation : 2006", "Redevance pour protection du milieu aquatique Recette : 8,5 millions d'euros Date de cr√©ation : 1941", "Redevances de l'eau dans les d√©partements d'outre-mer Recette : 2 millions d'euros Date de cr√©ation : 2006", "Redevance pour d√©livrance initiale du permis de chasse", "Redevances cyn√©g√©tiques", "Redevance de mise sur le march√© des substances actives biocides", "Participation pour voirie et r√©seaux    Date de cr√©ation : 2000", "Redevance pour cr√©ation de bureaux ou de locaux de recherche en r√©gion Ile-de-France Recette : 124,5 millions d'euros Date de cr√©ation : 1960", "Fraction des produits annuels de la vente de biens confisqu√©s", "Contributions au Fonds de garantie des assurances obligatoires de dommages (FGAO)    Date de cr√©ation : 1951", "Contribution au Fonds de garantie des victimes des actes de terrorisme et d'autres infractions    Date de cr√©ation : 1986", "Contribution au fonds de garantie des dommages cons√©cutifs √† des actes de pr√©vention, de diagnostic ou de soins dispens√©s par des professionnels de sant√© Recette : 0,9 millions d'euros Date de cr√©ation : 2011", "Pr√©l√®vement \"assurance fronti√®re\" automobile Recette : 0 millions d'euros Date de cr√©ation : 2007", "Droit de francisation et de navigation¬†en Corse,¬†Droit de passeport¬†en Corse Recette : 3 millions d'euros Date de cr√©ation : 1994", "Droit de francisation et de navigation Recette : 39,2 millions d'euros Date de cr√©ation : 1967", "Droit de passeport Recette : 2,2 millions d'euros Date de cr√©ation : 1967", "Taxe int√©rieure de consommation sur les produits √©nerg√©tiques¬†(TICPE) Recette : 24500 millions d'euros Date de cr√©ation : 1928", "Contribution au service public de l'√©lectricit√©¬†(CSPE)    Date de cr√©ation : 2003", "Taxe g√©n√©rale sur les activit√©s polluantes¬†- mat√©riaux d'extraction Recette : 72,5 millions d'euros Date de cr√©ation : 1999", "Taxe g√©n√©rale sur les activit√©s polluantes¬†- √©missions polluantes Recette : 21,6 millions d'euros Date de cr√©ation : 1998", "Taxe g√©n√©rale sur les activit√©s polluantes¬†- installations class√©es Recette : 25 millions d'euros Date de cr√©ation : 1999", "Taxe int√©rieure sur les houilles, les lignites et les cokes¬†(TICHLC) Recette : 7,6 millions d'euros Date de cr√©ation : 2006", "Taxe g√©n√©rale sur les activit√©s polluantes¬†- lessives Recette : 44,4 millions d'euros Date de cr√©ation : 1999", "Taxe g√©n√©rale sur les activit√©s polluantes¬†(TGAP)    Date de cr√©ation : 2000", "Taxe sp√©ciale sur certains v√©hicules routiers", "Taxe due par les entreprises de transport public a√©rien et maritime (Outre-Mer) Recette : 9,4 millions d'euros Date de cr√©ation : 1994", "Taxe sur les passagers maritimes embarqu√©s √† destination d'espaces naturels prot√©g√©s Recette : 2,6 millions d'euros Date de cr√©ation : 1995", "Redevance relative aux contr√¥les renforc√©s √† l'importation des denr√©es alimentaires d'origine non animale Recette : 3,4 millions d'euros Date de cr√©ation : 1998", "Redevance relative aux contr√¥les renforc√©s √† l'importation des denr√©es alimentaires d'origine non animale Recette : 0 millions d'euros Date de cr√©ation : 2011", "Redevances d'usage des fr√©quences radio√©lectriques¬†(part ANFR) Recette : 15,8 millions d'euros Date de cr√©ation : 1993", "Droit d√ª par les entreprises ferroviaires pour l'autorit√© de r√©gulation des activit√©s ferroviaires", "Droit de s√©curit√© Recette : 16,8 millions d'euros Date de cr√©ation : 2006", "Taxe sur les titulaires d'ouvrages hydro√©lectriques conc√©d√©s", "P√©age plaisance", "Taxe sur le prix des entr√©es aux s√©ances organis√©es par les exploitants d'√©tablissements de spectacles cin√©matographiques", "Cotisations (normale et suppl√©mentaire) des entreprises cin√©matographiques", "Redevance d'arch√©ologie pr√©ventive Recette : 77 millions d'euros Date de cr√©ation : 2001", "Redevances per√ßues pour la surveillance des √©tablissements de jeux, hippodromes et cynodromes Recette : 0 millions d'euros Date de cr√©ation : <1979", "Contribution des employeurs √† l'association pour la gestion du r√©gime d'assurance des cr√©ances des salari√©s", "Contribution annuelle au fonds de d√©veloppement pour l'insertion professionnelle des handicap√©s", "Participation des entreprises de moins de 10 salari√©s au d√©veloppement de la formation professionnelle continue", "PEFPC¬†: Participation des entreprises de 10 salari√©s et plus au d√©veloppement de la formation professionnelle continue", "Participation au financement de la formation des professions non salari√©es¬†(hors artisanat, agriculture et p√™che) Recette : 58 millions d'euros Date de cr√©ation : 1991", "Participation au financement de la formation des travailleurs ind√©pendants et des employeurs de la p√™che maritime ou des cultures marines Recette : 0,4 millions d'euros Date de cr√©ation : 1997", "Participation au financement de la formation des professions non salari√©es dans le domaine agricole Recette : 49 millions d'euros Date de cr√©ation : 1991", "Participation au financement des cong√©s individuels de formation des salari√©s sous contrats √† dur√©e d√©termin√©e CIF-CDD", "Contribution sp√©ciale vers√©e par les employeurs des √©trangers sans autorisation de travail", "Pr√©l√®vement sur les contrats d'assurance-vie en d√©sh√©rence", "Taxe dans le domaine fun√©raire Recette : 5 millions d'euros Date de cr√©ation : 1806", "Taxe locale sur la publicit√© ext√©rieure¬†(TLPE) Recette : 153 millions d'euros Date de cr√©ation : 2009", "Taxe sur les remont√©es m√©caniques Recette : 54 millions d'euros Date de cr√©ation : 1968", "Versement transport", "Taxe sur les activit√©s commerciales non salari√©s √† dur√©e saisonni√®re    Date de cr√©ation : 2000", "Taxe sur les activit√©s commerciales saisonni√®res non salari√©es¬†(TACDS)    Date de cr√©ation : 2000", "Taxe sur les d√©chets r√©ceptionn√©s dans une installation de stockage ou un incin√©rateur de d√©chets m√©nagers Recette : 18,9 millions d'euros Date de cr√©ation : 2005", "Taxe additionnelle d√©partementale √† la taxe de s√©jour Recette : 9 millions d'euros Date de cr√©ation : 1927", "Droits assimil√©s au droit d'octroi de mer sur les rhums et spiritueux √† base d'alcool de cru Recette : 5,1 millions d'euros Date de cr√©ation : 1963", "Imp√¥t sur le revenu¬†(IR) Recette : 74000 millions d'euros Date de cr√©ation : 1916", "Taxe sur les m√©taux pr√©cieux, les bijoux, les objets d'art, de collection et d'antiquit√© Recette : 96,7 millions d'euros Date de cr√©ation : 1976", "Imp√¥t sur les revenus de capitaux mobiliers¬†(IRCM)", "Imp√¥t sur les soci√©t√©s¬†(IS) Recette : 36200 millions d'euros Date de cr√©ation : 1948", "Taxe sur les salaires", "Taxe annuelle sur les locaux √† usage de bureaux, les locaux commerciaux, les locaux de stockage et les surfaces de stationnement per√ßue dans certains d√©partements¬†(IF-AUT-50)", "Taxe annuelle sur les logements vacants¬†(IF-AUT-60)    Date de cr√©ation : 1998", "contribution sur les revenus locatifs¬†(CRL) Recette : 0,2 millions d'euros Date de cr√©ation : 2000", "Taxe sur les exc√©dents de provisions des entreprises d'assurances de dommages Recette : 114,6 millions d'euros Date de cr√©ation : 1983", "Taxe sur les ordres annul√©s dans le cadre d'op√©ration √† haute fr√©quence Recette : 0,1 millions d'euros Date de cr√©ation : 2012", "Taxe sur les contrats d'√©change sur d√©faut d'un √âtat Recette : 0,6 millions d'euros Date de cr√©ation : 2012", "Taxe sur la valeur ajout√©e (TVA) Recette : 141200 millions d'euros Date de cr√©ation : 1954", "Taxe sur les services num√©riques Recette : 350 millions d'euros Date de cr√©ation : 2019", "Taxe de solidarit√© sur les billets d'avion¬†(dite¬†taxe Unitaid¬†ou¬†taxe Chirac) Recette : 161,99 millions d'euros Date de cr√©ation : 2006", "Taxe de l'aviation civile¬†(TAC) Recette : 401 millions d'euros Date de cr√©ation : 1999", "Taxe sur certaines d√©penses de publicit√©", "Taxe sur le chiffre d'affaires des exploitants agricoles Recette : 138,2 millions d'euros Date de cr√©ation : 1947", "Redevance sanitaire d'abattage Recette : 48 millions d'euros Date de cr√©ation : 1989", "Redevance sanitaire de d√©coupage Recette : 48,1 millions d'euros Date de cr√©ation : 1989", "Redevance sanitaire de transformation des produits de la p√™che et de l'aquaculture Recette : 0,3 millions d'euros Date de cr√©ation : 1998", "Redevance sanitaire de transformation des produits de la p√™che et de l'aquaculture Recette : 0,1 millions d'euros Date de cr√©ation : 1998", "Redevance sanitaire pour le contr√¥le de certaines substances et de leurs r√©sidus Recette : 0,8 millions d'euros Date de cr√©ation : 1998", "Redevance pour l'agr√©ment des √©tablissements du secteur de l'alimentation animale Recette : 0 millions d'euros Date de cr√©ation : 2009", "Taxe due par les concessionnaires d'autoroutes", "Contribution sur la cession √† un service de t√©l√©vision des droits de diffusion de manifestations ou de comp√©titions sportives Recette : 43 millions d'euros Date de cr√©ation : 1999", "Pr√©l√®vements sur les jeux et paris Recette : 115,3 millions d'euros Date de cr√©ation : 2010", "Fraction du Pr√©l√®vement sur les mises de jeux de cercle en ligne affect√©e aux communes dans le ressort territorial desquelles sont ouverts au public un ou plusieurs casinos", "Fraction du Pr√©l√®vement sur les paris hippiques affect√©e aux EPCI sur le territoire desquels sont ouverts au public un ou plusieurs hippodromes", "Droit de consommation sur les produits interm√©diaires Recette : 104,7 millions d'euros Date de cr√©ation : 1945", "Droits de consommation sur les alcools", "Droit de circulation sur les vins, cidres, poir√©s et hydromels Recette : 122,2 millions d'euros Date de cr√©ation : 1945", "Droit sur les bi√®res et les boissons non alcoolis√©es", "Droit de consommation sur les tabacs manufactur√©s", "Mutations √† titre on√©reux de fonds de commerce", "Droits de succession", "Droit fixe pour l'√©tablissement d'un contrat de mariage Recette : 4,5 millions d'euros", "Fraction des droits de timbre sur les passeports s√©curis√©s", "Droit de timbre sur les demandes de naturalisation, les demandes de r√©int√©gration dans la nationalit√© fran√ßaise et les d√©clarations d'acquisition de la nationalit√© en raison du mariage", "Imp√¥t sur la fortune immobili√®re¬†(PAT-IFI) Recette : 5043 millions d'euros Date de cr√©ation : 1982", "Taxe sp√©ciale sur les conventions d'assurances    Date de cr√©ation : 1944", "Majoration de la taxe sur les assurances de protection juridique au profit Conseil national des barreaux", "Taxe sur les v√©hicules de soci√©t√©s¬†(TVS)", "Taxe sur les v√©hicules de tourisme les plus polluants", "Malus¬†(ou ¬´¬†√©copastille¬†¬ª)", "Malus annuel", "Taxe fonci√®re sur les propri√©t√©s b√¢ties¬†(IF-TFB) Recette : 27285 millions d'euros", "Taxe fonci√®re sur les propri√©t√©s non b√¢ties¬†(IF-TFNB) Recette : 980 millions d'euros", "Taxe d'habitation¬†(IF-TH) Recette : 19352 millions d'euros", "Taxe d'habitation sur les logements vacants    Date de cr√©ation : 2007", "Cotisation fonci√®re des entreprises¬†(IF-CFE) Recette : 21872 millions d'euros", "Redevances communale et d√©partementale des mines¬†(TFP-MINES) Recette : 23,4 millions d'euros Date de cr√©ation : 1919", "Imposition forfaitaire sur les pyl√¥nes¬†(TFP-PYL) Recette : 343,4 millions d'euros Date de cr√©ation : 1980", "Taxe sur les √©oliennes maritimes¬†(TFP-TEM) Recette : 0 millions d'euros Date de cr√©ation : 2005", "Imposition forfaitaire sur les √©oliennes et les hydroliennes Recette : 44,9 millions d'euros Date de cr√©ation : 2010", "Imposition forfaitaire sur les centrales de production d'√©nergie √©lectrique d'origine photovolta√Øque ou hydraulique Recette : 75,9 millions d'euros Date de cr√©ation : 2010", "Imposition forfaitaire sur les r√©seaux de gaz naturel et canalisations d'hydrocarbures Recette : 38,5 millions d'euros Date de cr√©ation : 2010", "Redevances sur la production d'√©lectricit√© au moyen de la g√©othermie Recette : 0 millions d'euros Date de cr√©ation : 2017", "Taxe additionnelle √† la taxe fonci√®re sur les propri√©t√©s non b√¢ties¬†(IF-AUT-80)", "Taxe d'enl√®vement des ordures m√©nag√®res¬†(IF-AUT-90)) Recette : 6087 millions d'euros", "Taxe de balayage Recette : 108,9 millions d'euros Date de cr√©ation : 1873", "Taxe forfaitaire sur la cession √† titre on√©reux des terrains nus qui ont √©t√© rendus constructibles du fait de leur classement Recette : 54 millions d'euros Date de cr√©ation : 2006", "Taxe pour la gestion des milieux aquatiques et la pr√©vention des inondations", "Taxe sur les friches commerciales¬†(IF-AUT-110)    Date de cr√©ation : 2006", "Imp√¥t sur les cercles et maisons de jeux Recette : 34,5 millions d'euros Date de cr√©ation : 1941", "Surtaxe sur les eaux min√©rales", "Taxe per√ßue au profit des communes de Saint-Martin et Saint-Barth√©lemy", "Taxe sur l'exploration d'hydrocarbures¬†(TFP-TEH) Recette : 0,8 millions d'euros Date de cr√©ation : 2017", "Taxe de publicit√© fonci√®re", "Droits d√©partementaux d'enregistrement sur les mutations √† titre on√©reux d'immeubles", "Taxe d√©partementale additionnelle aux droits d'enregistrement ou √† la taxe de publicit√© fonci√®re exigible sur les mutations √† titre on√©reux Recette : 99,8 millions d'euros Date de cr√©ation : 1798", "Taxe d'apprentissage Recette : 2000 millions d'euros Date de cr√©ation : 1925", "Imposition forfaitaire sur le mat√©riel roulant circulant sur le r√©seau de transport ferroviaire et guid√© g√©r√© par la RATP -IFER-STIF RATP", "Taxe annuelle sur les surfaces de stationnement    Date de cr√©ation : 2015", "Taxe additionnelle sp√©ciale annuelle au profit de la r√©gion √éle-de-France¬†(TASA)    Date de cr√©ation : 2015", "Taxe per√ßue pour la r√©gion de Guyane¬†(TFP-GUF) Recette : 0,4 millions d'euros Date de cr√©ation : 2008", "Taxe sur les permis de conduire", "Taxe r√©gionale sur les certificats d'immatriculation des v√©hicules", "Taxe due par les entreprises de transport public a√©rien et maritime (Corse) Recette : 47,4 millions d'euros Date de cr√©ation : 1991", "Taxe pour frais de chambres de commerce et d'industrie¬†(IF-AUT-10)", "Contribution sociale g√©n√©ralis√©e¬†(CSG) Recette : 99000 millions d'euros Date de cr√©ation : 1991", "Pr√©l√®vement social sur les revenus du patrimoine et les produits de placements", "Contribution pour le remboursement de la dette sociale¬†(CRDS) Recette : 6150 millions d'euros Date de cr√©ation : 1996", "Pr√©l√®vement de solidarit√© de 2¬†% sur les revenus du patrimoine et les produits de placements", "Taxe pour frais de chambres de m√©tiers et de l'artisanat¬†(IF-AUT-20)", "Contribution au fonds d'assurance formation des chefs d'entreprise inscrite au r√©pertoire des m√©tiers Recette : 58 millions d'euros Date de cr√©ation : 1982", "Taxe pour frais de chambres d'agriculture¬†(IF-AUT-30)", "Taxe sur la cession √† titre on√©reux de terrains nus devenus constructibles; per√ßue au profit de l'agence de services et de paiement Recette : 11 millions d'euros Date de cr√©ation : 2010", "Contribution √† l'audiovisuel public due par les professionnels¬†(TFP-CAP) Recette : 3500 millions d'euros Date de cr√©ation : 1933", "Taxe sp√©ciale d'√©quipement Recette : 350 millions d'euros Date de cr√©ation : 1991", "Taxe sp√©ciale d'√©quipement¬†au profit de l'EPF de Normandie Recette : 13 millions d'euros Date de cr√©ation : 1968", "Redevance sur les paris hippiques en ligne per√ßue au profit des soci√©t√©s de courses Recette : 61 millions d'euros Date de cr√©ation : 2014", "Taxe sur les nuisances sonores a√©riennes Recette : 57 millions d'euros Date de cr√©ation : 1992", "Contribution des autoentrepreneurs au financement des actions de formation des chambres de m√©tiers et d'artisanat Recette : 2 millions d'euros Date de cr√©ation : 2010", "Contribution des autoentrepreneurs au fonds d'assurance formation des chefs d'entreprise artisanale Recette : 3 millions d'euros Date de cr√©ation : 2010", "Taxe sur la diffusion en vid√©o physique et en ligne de contenus audiovisuels Recette : 30,95 millions d'euros Date de cr√©ation : 1993", "Contribution suppl√©mentaire √† l'apprentissage - versements aux CFA", "Taxe pour le d√©veloppement de la formation professionnelle dans les m√©tiers de la r√©paration automobile, du cycle et du motocycle Recette : 32 millions d'euros Date de cr√©ation : 1968", "Pr√©l√®vements sur les jeux de loterie et les paris sportifs per√ßus au profit du Centre national pour le d√©veloppement du sport Recette : 35,9 millions d'euros Date de cr√©ation : 2010", "Taxe sp√©ciale d'√©quipement¬†au profit de l'EPF de Guyane et de Mayotte Recette : 2 millions d'euros Date de cr√©ation : 1994", "Taxe sp√©ciale d'√©quipement¬†au profit de la Soci√©t√© du Grand Paris Recette : 117 millions d'euros Date de cr√©ation : 2010", "Taxe sp√©ciale d'√©quipement¬†au profit de l'EPF de Lorraine Recette : 23 millions d'euros Date de cr√©ation : 1973", "Taxe sp√©ciale d'√©quipement¬†au profit de l'EPF de PACA Recette : 50 millions d'euros Date de cr√©ation : 2001", "Taxe sur les boissons pr√©mix Recette : 2,3 millions d'euros Date de cr√©ation : 1996", "Contribution per√ßue sur les boissons et pr√©parations liquides destin√©es √† la consommation humaine contenant des √©dulcorants de synth√®se et ne contenant pas de sucres ajout√©s Recette : 58,4 millions d'euros Date de cr√©ation : 2011", "Droit de timbre pour la d√©livrance du permis de conduire en cas de perte ou de vol", "Taxes √† percevoir pour l'alimentation du fonds commun des accidents du travail agricole Recette : 17,3 millions d'euros Date de cr√©ation : 1957", "Fraction des droits de timbre sur les cartes nationales d'identit√©", "Taxe pour la gestion des certificats d'immatriculation des v√©hicules Recette : 42 millions d'euros Date de cr√©ation : 2009", "Contributions additionnelles aux primes ou cotisations aff√©rentes √† certaines conventions d'assurance", "Contribution au Fonds de pr√©vention des risques naturels majeurs¬†(FPRNM, dit ¬´¬†fonds Barnier¬†¬ª)    Date de cr√©ation : 1995", "Droits per√ßus au profit de la Caisse nationale de l'assurance maladie des travailleurs salari√©s (CNAMTS) en mati√®re de produits de sant√©, taxe annuelle due par les laboratoires de biologie m√©dicale", "Taxe destin√©e √† financer le d√©veloppement de la formation professionnelle dans les transports routiers Recette : 65 millions d'euros Date de cr√©ation : 1968", "Droit d'examen du permis de chasse", "Droits affect√©s au fonds d'indemnisation de la profession d'avou√©s pr√®s les cours d'appel Recette : 16 millions d'euros Date de cr√©ation : 2011", "Imposition forfaitaire sur les entreprises de r√©seaux¬†(TFP-IFER) Recette : 1337 millions d'euros Date de cr√©ation : 2010", "Taxe communale sur la consommation finale d'√©lectricit√©¬†(TCFE) Recette : 61,9 millions d'euros Date de cr√©ation : 2010", "Taxe d√©partementale des espaces naturels sensibles¬†(TDENS)", "Redevance d'exploitation de substances non √©nerg√©tiques sur le plateau continental ou dans la zone √©conomique exclusive", "Redevance due par les titulaires de titres d'exploitation de mines d'hydrocarbures liquides ou gazeux Recette : 3,1 millions d'euros Date de cr√©ation : 1956", "Redevance due par les titulaires de titres d'exploitation de mines d'hydrocarbures liquides ou gazeux au large de Saint-Pierre-et-Miquelon    Date de cr√©ation : 1999", "Contribution pour frais de contr√¥le ACPR", "Droits et contributions pour frais de contr√¥le", "Redevance pour contr√¥le v√©t√©rinaire √† l'exp√©dition    Date de cr√©ation : <2000", "Redevance relative aux contr√¥les renforc√©s √† l'importation des denr√©es alimentaires d'origine non animale Recette : 1,1 millions d'euros Date de cr√©ation : 1998", "Contribution des exploitants agricoles et des conchyliculteurs au Fonds national de gestion des risques en agriculture Recette : 102 millions d'euros Date de cr√©ation : 1993", "Droit sur les produits b√©n√©ficiant d'une appellation d‚Äôorigine, d'une indication g√©ographique ou d'un label rouge Recette : 7 millions d'euros Date de cr√©ation : 1935", "Participation au financement de la formation des professions non salari√©es dans le domaine agricole", "Taxe additionnelle √† la taxe sur les installations nucl√©aires de base - stockage Recette : 2,4 millions d'euros Date de cr√©ation : 2009", "Taxe additionnelle √† la taxe sur les installations nucl√©aires de base - Diffusion technologique Recette : 20 millions d'euros Date de cr√©ation : 2006", "Taxe additionnelle √† la taxe sur les installations nucl√©aires de base - Accompagnement Recette : 39 millions d'euros Date de cr√©ation : 2006", "Taxe pour le d√©veloppement des industries de l'ameublement ainsi que les industries du bois Recette : 14,9 millions d'euros Date de cr√©ation : 1971", "Taxe pour le d√©veloppement des industries du cuir, de la maroquinerie, de la ganterie et de la chaussure Recette : 12,5 millions d'euros Date de cr√©ation : 1978", "Taxe pour le d√©veloppement des industries de l'habillement Recette : 10 millions d'euros Date de cr√©ation : 1963", "Taxe pour le d√©veloppement des industries de la m√©canique, de la construction m√©tallique, des mat√©riels etc. Recette : 70,2 millions d'euros Date de cr√©ation : 1961", "Taxe pour le d√©veloppement des industries de l'horlogerie, bijouterie, joaillerie et orf√®vrerie ainsi que des arts de la table¬†(taxe HBJOAT) Recette : 13,2 millions d'euros Date de cr√©ation : 1963", "Taxe pour le d√©veloppement des industries des mat√©riaux de construction regroupant les industries du b√©ton, de la terre cuite et des roches ornementales et de construction Recette : 15,9 millions d'euros Date de cr√©ation : 1957", "Taxe pour le d√©veloppement de l'industrie de la conservation des produits agricoles Recette : 2,6 millions d'euros Date de cr√©ation : 1950", "Taxe sur les spectacles de vari√©t√©s Recette : 24 millions d'euros Date de cr√©ation : 1977", "Taxe sur les spectacles d'art dramatique, lyrique et chor√©graphique Recette : 5,1 millions d'euros Date de cr√©ation : 1964", "Redevance pour frais d'envoi des certificats d'immatriculation des v√©hicules", "Fraction affect√©e du produit du rel√®vement du tarif de taxe int√©rieure de consommation sur les produits √©nerg√©tiques (TICPE) sur le carburant gazole", "Taxe sur les hydrofluorocarbures    Date de cr√©ation : 2018", "Contribution annuelle au profit de l'Institut de radioprotection et de s√ªret√© nucl√©aire¬†(IRSN) Recette : 48 millions d'euros Date de cr√©ation : 2010", "Taxe sur les transactions financi√®res¬†(TTF)", "Participation pour le Financement de l'Assainissement Collectif¬†(PFAC)", "Contribution sp√©ciale pour la gestion des d√©chets radioactifs - Conception", "Participation des concessionnaires de la liaison fixe Trans-Manche au fonctionnement de la commission intergouvernementale et du comit√© de s√©curit√© charg√©s de superviser la construction et l'exploitation de l'ouvrage Recette : 2,5 millions d'euros Date de cr√©ation : 1986", "Redevance proportionnelle sur l'√©nergie hydraulique", "Taxe pour frais de chambre de m√©tiers de Moselle Recette : 7 millions d'euros Date de cr√©ation : 1919", "Taxe pour frais de chambre de m√©tiers d'Alsace Recette : 9 millions d'euros Date de cr√©ation : 1919", "Pr√©l√®vements sur les b√©n√©fices tir√©s de la construction immobili√®re Recette : 0,4 millions d'euros Date de cr√©ation : 1963", "Participation des employeurs au financement de la formation professionnelle continue, vers√©e √† l'√âtat", "Taxe sur les surfaces commerciales¬†(TFP-TSC) Recette : 609 millions d'euros", "Taxe additionnelle √† la taxe sur les surfaces commerciales¬†(TFP-TASC)", "Taxe exceptionnelle sur la r√©serve de capitalisation des entreprises d'assurance¬†(TFP-ASSUR)", "Taxe au profit du fonds de soutien aux collectivit√©s territoriales ayant contract√© des produits structur√©s dits \"emprunts toxiques\"¬†(TFP-TFSCT)", "Cotisation obligatoire", "Cotisation obligatoire", "Taxe professionnelle de la Poste et de France Telecom", "Fraction du produit des successions en d√©sh√©rence", "Droit d'octroi de mer et droit d'octroi de mer r√©gional", "Contribution tarifaire d'acheminement¬†(CTA)    Date de cr√©ation : 2004", "Contributions vers√©es par la SNCF au titre des frais de surveillance et de contr√¥le des chemins de fer    Date de cr√©ation : 1981", "Redevance vers√©e par R√©seau ferr√© de France au titre des frais de surveillance et de contr√¥le    Date de cr√©ation : 1981", "Contributions des employeurs de main d'≈ìuvre √©trang√®re pour l'OMI", "Contribution des employeurs publics au fonds pour l'insertion des personnes handicap√©es dans la fonction publique", "Cotisation au profit des caisses d'assurances d'accidents agricoles d'Alsace-Moselle Recette : 12 millions d'euros Date de cr√©ation : 1912", "Droits d'apport des soci√©t√©s", "Droits de donations", "Mutations √† titre on√©reux de cr√©ances, rentes, prix d'offices", "Contributions au Fonds national de l'emploi¬†(FNE)", "Retenue √† la source sur certains b√©n√©fices non commerciaux et de l'imp√¥t sur le revenu", "Contribution des institutions financi√®res", "Cotisations aux fonds de garantie des salaires¬†(AGS et AGCC)", "Redevance d'usage des fr√©quences radio√©lectriques", "Redevances lors du lancement de certains mat√©riels a√©ronautiques", "Taxe grossiste r√©partiteurs", "Taxe sur les stations et liaisons radio priv√©es", "Taxe additionnelle aux droits de mutation", "Imp√¥t sur les spectacles, jeux et divertissements", "Participation d√©passement du COS", "Taxe locale d'√©quipement", "Taxe compl√©mentaire √† la TLE¬†(IdF)", "Taxe de s√©jour", "Taxe sur les tabacs¬†(Corse)", "Octroi de mer", "Taxe sur le ski de fond Recette : 10 millions d'euros Date de cr√©ation : 1985", "Contribution annuelle des distributeurs d'√©nergie", "Fonds d'amortissement des charges d'√©lectrification¬†(FAC√â)", "Pr√©l√®vement sur entreprises p√©troli√®res", "Taxe sur les fournitures d'√©lectricit√©", "Droits de consommation sur les alcools¬†(Corse)", "Taxe d'assainissement¬†(Agence de l'Eau)", "Taxe sur les rhums", "Taxe sur les carburants¬†(DOM)", "Taxe sur les syndicats d'√©nergie", "Redevance pour droit de construire¬†(EPAD)", "Taxe et pr√©l√®vement sur les sommes encaiss√©es par les soci√©t√©s de t√©l√©vision au titre de la redevance, de la diffusion des messages publicitaires et des abonnements Recette : 8 millions d'euros Date de cr√©ation : 1946", "Mutation √† titre on√©reux d'immeubles et droits immobiliers¬†(Droits de mutation)", "Mutations de jouissance¬†(baux)", "Fraction des Pr√©l√®vements sociaux sur les jeux pr√©vus aux Art L 137-20 √† L 137-22 Code de la s√©curit√© sociale", "Pr√©l√®vement sur la participation des employeurs √† l'effort de construction", "Cotisation obligatoire", "Taxe fixe due √† chaque d√©livrance de CI (AIS-MOB-10-20-20)", "Taxe r√©gionale due au titre de la d√©livrance de CI cons√©cutive d'un changement de propri√©taire", "Taxe sur les v√©hicules de transport due au titre de la d√©livrance de CI cons√©cutive √† un changement de propri√©taire", "Taxe sur les √©missions de dioxyde de carbone", "Taxe sur la masse en ordre de marche", "Taxe annuelle sur les √©missions de dioxyde de carbone", "Taxe annuelle sur les √©missions de polluants atmosph√©rique", "Taxe sur l'affectation des v√©hicules lourds de transport de marchandises (AIS-MOB-10-30-30)", "Taxe sur la distance parcourue sur le r√©seau autoroutier conc√©d√© (AIS-MOB-10-40)", "Taxes sur le transport a√©rien (AIS-MOB-20)", "Taxes sur les navigations maritimes et fluviales (AIS-MOB-30)", "Taxes sur le transport guid√© (AIS-MOB-40)", "Taxe sur l'exploitation des infrastructures de transport de longue distance (AIS-MOB-50)", "Taxe sur les services de communications √©lectroniques (AIS-CCN-30-10)", "Taxe sur les services de t√©l√©vision (AIS-CCN-30-20)", "Taxe sur les services d'acc√®s √† des contenus audiovisuels √† la demande (AIS-CCN-30-30)", "Taxe sur la mise en relation par voie √©lectronique en vue de fournir certaines prestations de transport (AIS-CCN-30-40) Recette : 2 millions d'euros Date de cr√©ation : 2021", "Taxe sur certains services num√©riques (AIS-CCN-30-50)", "Taxe sur les locations en France de phonogrammes musicaux et de vid√©omusiques destin√©s √† l‚Äôusage priv√© du public dans le cadre d‚Äôune mise √† disposition √† la demande sur les r√©seaux en ligne (AIS-CCN-30-60) Recette : 9,3 millions d'euros Date de cr√©ation : 2023", "Cotisation sur la valeur ajout√©e des entreprises¬†(CVAE)", "Pr√©l√®vements au profit de l'√âtat (IF-AUT-40)", "Taxe sp√©ciale compl√©mentaire au profit de la Soci√©t√© du Grand Projet du Sud-Ouest (IF-AUT-150)", "Taxe sp√©ciale d'√©quipement au profit des √©tablissements publics fonciers locaux et de l'office foncier de Corse", "Taxe sp√©ciale d'√©quipement au profit des √©tablissements publics fonciers de l‚Äô√âtat", "Taxe sp√©ciale d'√©quipement au profit des √©tablissements publics fonciers et d'am√©nagement de la Guyane et de Mayotte", "Taxe sp√©ciale d'√©quipement au profit de l'agence pour la mise en valeur des espaces urbains de la zone dite des cinquante pas g√©om√©triques en Guadeloupe", "Taxe sp√©ciale d'√©quipement au profit de l'agence pour la mise en valeur des espaces urbains de la zone dite des cinquante pas g√©om√©triques en Martinique.", "Taxe sp√©ciale d'√©quipement au profit de l'√©tablissement public Soci√©t√© des grands projets", "Taxe sp√©ciale d'√©quipement au profit de l'√©tablissement public local Soci√©t√© du Grand Projet du Sud-Ouest", "Taxe additionnelle sp√©ciale annuelle per√ßue au profit de la r√©gion √éle-de-France (IF-AUT-130)", "Taxe annuelle sur les surfaces de stationnement per√ßue en √éle-de-France (IF-AUT-140)", "Taxe sur la valeur v√©nale des immeubles des entit√©s juridiques (PAT-TPC)", "Contribution exceptionnelle sur les hauts revenus (IR-CHR)", "Taxe additionnelle √† l‚Äôaccise sur les tabacs    Date de cr√©ation : 2025", "Participation des employeurs agricoles √† l'effort de construction¬†(TPS-PEEC-60)    Date de cr√©ation : 2006", "Cotisation additionnelle assise sur le montant total des honoraires factur√©s par les commissaires aux comptes lorsqu'ils certifient les comptes ou les informations en mati√®re de durabilit√© des entit√©s d'int√©r√™t public    Date de cr√©ation : 2017", "Contribution forfaitaire des commissaires aux comptes exer√ßant dans les pays tiers    Date de cr√©ation : 2017", "Cotisation assise sur le montant total des honoraires factur√©s par les organismes tiers ind√©pendants lorsqu'ils certifient les informations en mati√®re de durabilit√©    Date de cr√©ation : 2017", "Cotisation additionnelle assise sur le montant total des honoraires factur√©s par les organismes tiers ind√©pendants lorsqu'ils certifient les informations en mati√®re de durabilit√© des entit√©s d'int√©r√™t public    Date de cr√©ation : 2017", "Eco-contribution sur la taxe de solidarit√© sur les billets d'avion", "Taxe d'a√©roport", "Taxe d'embarquement sur les passagers dans les territoires d'outre-mer", "Taxe d'atterrissage", "CSG Recette : 147500 millions d'euros", "CRDS Recette : 8853 millions d'euros Date de cr√©ation : 1996", "Contribution solidarit√© autonomie", "Assurance maladie - maternit√© - invalidit√© - d√©c√®s", "Assurance vieillesse plafonn√©e", "Assurance vieillesse d√©plafonn√©e", "Allocations familiales Recette : 35600 millions d'euros", "Accidents du travail Recette : 16000 millions d'euros", "Aide au logement entreprise de moins de 50 salari√©s (FNAL)", "Suppl√©ment entreprise de 50 salari√©s et plus (FNAL)", "Cotisation ch√¥mage", "Fonds national de garantie des salaires (AGS)", "Retraite compl√©mentaire CEG¬†tranche 1", "Retraite compl√©mentaire CEG tranche 2", "Retraite compl√©mentaire APEC (cadres seulement)", "Retraite compl√©mentaire Contribution patronale de pr√©voyance (forfait social) entreprises de 11 √† 49 salari√©s", "Retraite compl√©mentaire Contribution patronale de pr√©voyance (forfait social) entreprises de 50 salari√©s et plus", "Retraite compl√©mentaire Cotisations de base", "Retraite compl√©mentaire tranche 1", "Retraite compl√©mentaire tranche 2", "Retraite compl√©mentaire CET¬†: T1 + T2 si r√©mun√©ration sup√©rieure au plafond de la S√©curit√© sociale (3.666 ‚Ç¨)", "assurance d√©c√®s cadre (adh√©sion obligatoire pour les cadres quel que soit le secteur d'activit√©)", "Contribution formation professionnelle Entreprise de moins de 11 salari√©s", "Contribution formation professionnelle Entreprise de 11 salari√©s ou plus", "Contribution formation professionnelle Entreprise avec CDD (CPF-CDD)", "Taxe d'apprentissage", "Taxe sur les salaires (employeur non assujetti √† la TVA)", "Versement mobilit√© (transport) entreprises de 11 salari√©s et plus", "Participation √† l'effort de construction (entreprises de 50 salari√©s et plus)", "Contribution au Dialogue social"
];

const canvas = document.getElementById('wheel'), ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height, CX = W/2, CY = H/2, R = Math.min(W,H) * 0.48;
const wheelArea = document.getElementById('wheelArea');
const btn = document.getElementById('spinBtn');
const overlay = document.getElementById('overlay'), overlayText = document.getElementById('overlayText');
const overlayClose = document.getElementById('overlayClose'), copyBtn = document.getElementById('copyText');

const spinSoundSrc = 'audio/wheel-spin2.mp3'; // short click sound used per-sector
const coinSound = new Audio('audio/coin3.mp3'); coinSound.volume = 0.95;

/* Tuning */
const rotationFactor = 1.4;
const MAX_VEL = 0.45 * rotationFactor;
const BOOST = 0.05 * rotationFactor;
const BASE_DAMPING = 0.9945 + (rotationFactor - 1) * 0.0015;
const LERP = 0.10;

/* STATE */
let angle = -Math.PI/2;
let angularVelocity = 0;
let targetVelocity = 0;
let frictionTimer = 0, frictionDuration = 0, frictionActive = false;
let showedResult = false, hasBeenSpun = false;

/* OFFSCREEN LAYER */
const off = document.createElement('canvas'); off.width = W; off.height = H; const offctx = off.getContext('2d');

/* COLORS PERSISTANTES */
const COLOR_PALETTE = ["#f87171","#60a5fa","#34d399","#fbbf24","#a78bfa","#fb923c","#2dd4bf","#c084fc"];
let entryColors = [];
function buildColors(){
  if(entryColors.length === 0) for(let i=0;i<ENTRIES.length;i++) entryColors.push(COLOR_PALETTE[i%COLOR_PALETTE.length]);
  while(entryColors.length < ENTRIES.length) entryColors.push(COLOR_PALETTE[entryColors.length % COLOR_PALETTE.length]);
  return entryColors;
}

/* IMAGE CENTRALE */
const centerImg = new Image(); centerImg.src = 'images/center3.avif'; let centerLoaded = false;
centerImg.onload = () => { centerLoaded = true; };

/* =======================
   DESSIN ROUE
   ======================= */
function buildStaticWheel(){
  const n = ENTRIES.length;
  const colors = buildColors();
  offctx.clearRect(0,0,W,H);
  offctx.save(); offctx.translate(CX,CY);
  const step = (Math.PI*2)/n;

  // secteurs color√©s
  for (let i=0;i<n;i++){
    offctx.beginPath();
    offctx.moveTo(0,0);
    offctx.arc(0,0,R,i*step,(i+1)*step);
    offctx.closePath();
    offctx.fillStyle = colors[i];
    offctx.fill();
  }

  // texte radial, r√©duit pour ne pas d√©passer la zone color√©e
  offctx.fillStyle = "#111";
  offctx.textAlign = "center";
  offctx.textBaseline = "middle";
  const labelR = R * 0.63;
  const maxWidthBase = R * 0.45;

  for (let i=0;i<n;i++){
    let text = String(ENTRIES[i] || "");
    const mid = (i + 0.5) * step;
    const x = Math.cos(mid) * labelR;
    const y = Math.sin(mid) * labelR;

    offctx.save();
    offctx.translate(x,y);
    offctx.rotate(mid);

    let fontSize = Math.max(10, 18 - text.length / 15);
    offctx.font = `${fontSize}px Poppins, sans-serif`;
    const maxWidth = maxWidthBase;

    while (offctx.measureText(text).width > maxWidth && fontSize > 8) {
      fontSize -= 1;
      offctx.font = `${fontSize}px Poppins, sans-serif`;
    }

    let truncated = text;
    while (offctx.measureText(truncated).width > maxWidth && truncated.length > 3) {
      truncated = truncated.slice(0, -1);
    }
    if (truncated.length < text.length) truncated = truncated.trim() + "‚Ä¶";

    offctx.fillText(truncated, 0, 0);
    offctx.restore();
  }

  offctx.restore();
}

function drawWheel(a){
  ctx.clearRect(0,0,W,H);
  ctx.save();
  ctx.translate(CX,CY);
  ctx.rotate(a);
  ctx.drawImage(off, -CX, -CY);

  if (centerLoaded){
    const imgSize = R * 1.05;
    ctx.save();
    ctx.rotate(Math.PI / 2);
    ctx.beginPath();
    ctx.arc(0,0,imgSize/2,0,Math.PI*2);
    ctx.closePath();
    ctx.clip();
    // image dessinn√©e dans le contexte tourn√© -> elle tourne avec la roue
    ctx.drawImage(centerImg, -imgSize/2, -imgSize/2, imgSize, imgSize);
    ctx.restore();
  }

  ctx.restore();
}

/* =======================
   INTERACTION / BOOST
   ======================= */
function boostWheel(e){
  hasBeenSpun = true;

  spawnBills(e, 8);

  if (Math.abs(angularVelocity) < 0.01) {
    targetVelocity = Math.min(MAX_VEL, targetVelocity + BOOST * 3.0);
    angularVelocity = Math.min(MAX_VEL, angularVelocity + BOOST * 1.0);
  } else {
    const boostFactor = 1 + Math.min(Math.abs(angularVelocity) * 8, 1.8);
    targetVelocity = Math.min(MAX_VEL, targetVelocity + BOOST * boostFactor);
    angularVelocity = Math.min(MAX_VEL, angularVelocity + BOOST * 0.6);
  }

  // d√©sactive bri√®vement la friction pour sentir le boost
  frictionActive = false; frictionTimer = 0;
  clearTimeout(window._frictionResume);
  window._frictionResume = setTimeout(()=>{ frictionActive = true; }, 600);

  showedResult = false;
}
canvas.addEventListener('mousedown', boostWheel);
canvas.addEventListener('touchstart', boostWheel, {passive:true});
btn.addEventListener('click', boostWheel);

/* =======================
   SON PAR PASSAGE DE SECTEUR
   ======================= */
animate && (animate.prevIndex = -1); // s√©curit√©
function playSectorClick(){
  try {
    const snd = new Audio(spinSoundSrc);
    snd.volume = 0.7;
    const absVel = Math.abs(angularVelocity);
    const rate = Math.min(2.5, Math.max(0.5, absVel * 80 + 0.5));
    snd.playbackRate = rate;
    snd.play().catch(()=>{});
  } catch(e){}
}

/* =======================
   SELECTION / OVERLAY
   ======================= */
function getSelectedIndex(a){
  const n = ENTRIES.length;
  if (n === 0) return -1;
  const step = (Math.PI*2)/n;
  let theta = (-Math.PI/2 - a) % (Math.PI*2);
  if (theta < 0) theta += Math.PI*2;
  return Math.floor(theta / step);
}

function showOverlay(text){
  const intros = [
    "üéØ Le sort a parl√© !", 
    "‚ú® Voici le r√©sultat :", 
    "üçÄ Et le gagnant est‚Ä¶"];
  const intro = intros[Math.floor(Math.random()*intros.length)];
  const formatted = String(text)
    .replace(/(Recette\s*:)/gi,"\n$1")
    .replace(/(Date de cr√©ation\s*:)/gi,"\n$1")
    .replace(/\n/g,"<br>");

  // üí¨ contenu principal du r√©sultat
  overlayText.innerHTML = `
    ${intro}<br><br>${formatted}
    <div class="feedback-buttons">
      <a id="btn-info" class="feedback-btn" href="#">Donner un compl√©ment d'information</a>
      <a id="btn-error" class="feedback-btn" href="#">Signaler une erreur</a>
    </div>
  `;

  overlay.style.display = 'flex';
  overlay.setAttribute('aria-hidden','false');

  // üß© branche les deux boutons √† ton formulaire Netlify
  const infoBtn = document.getElementById("btn-info");
  const errorBtn = document.getElementById("btn-error");

  if (infoBtn && errorBtn) {
    infoBtn.addEventListener("click", (e) => {
      e.preventDefault();
      const userMsg = prompt("üí¨ Ajoutez votre compl√©ment d'information :");
      if (userMsg) sendFeedbackToGitHub(text, userMsg, "info");
    });

    errorBtn.addEventListener("click", (e) => {
      e.preventDefault();
      const userMsg = prompt("‚ö†Ô∏è D√©crivez l'erreur que vous avez trouv√©e :");
      if (userMsg) sendFeedbackToGitHub(text, userMsg, "error");
    });
  }
}

// handlers for the feedback modal (adapt to your showOverlay call)
const openBtn = document.getElementById('openFeedbackForm');
const modal = document.getElementById('feedbackModal');
const form = document.getElementById('feedbackForm');
const closeBtn = document.getElementById('closeFeedback');
const status = document.getElementById('feedbackStatus');

function openFeedback(resultText){
  document.getElementById('formResult').value = resultText;
  document.getElementById('formMessage').value = '';
  document.getElementById('formEmail').value = '';
  document.getElementById('honeypot').value = '';
  status.style.display = 'none';
  modal.style.display = 'flex';
}

closeBtn.addEventListener('click', ()=> modal.style.display='none');
modal.addEventListener('click', (e)=> { if (e.target === modal) modal.style.display='none'; });

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  status.style.display = 'block'; status.textContent = 'Envoi en cours‚Ä¶';
  const payload = {
    resultText: document.getElementById('formResult').value,
    userMessage: document.getElementById('formMessage').value,
    userEmail: document.getElementById('formEmail').value,
    honeypot: document.getElementById('honeypot').value || ''
  };
  try {
    const resp = await fetch('/.netlify/functions/sendFeedback', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });
    const json = await resp.json();
    if (json.ok) {
      status.textContent = 'Merci ‚Äî votre message a √©t√© envoy√© !';
      if (json.url) {
        status.innerHTML += `<br><a href="${json.url}" target="_blank" rel="noopener">Voir le ticket sur GitHub</a>`;
      }
      setTimeout(()=> modal.style.display='none', 1500);
    } else {
      status.textContent = 'Erreur lors de l‚Äôenvoi : ' + (json.error || 'unknown');
    }
  } catch (err) {
    console.error(err);
    status.textContent = 'Erreur r√©seau lors de l‚Äôenvoi.';
  }
});

overlayClose.addEventListener('click',()=>{ overlay.style.display='none'; overlay.setAttribute('aria-hidden','true'); });
overlay.addEventListener('click', e => { if (e.target === overlay) { overlay.style.display='none'; overlay.setAttribute('aria-hidden','true'); }});
overlay.querySelector('.bubble').addEventListener('click', e => e.stopPropagation());
copyBtn && copyBtn.addEventListener('click', async ()=>{
  try { await navigator.clipboard.writeText(overlayText.innerText); copyBtn.textContent = '‚úÖ'; setTimeout(()=>copyBtn.textContent='üìã',800); }
  catch(e){ alert('Impossible de copier'); }
});

/* =======================
   ANIMATION
   ======================= */
let lastTime = performance.now();
function animate(){
  const now = performance.now();
  const deltaTime = Math.min(10, (now - lastTime) / 16.67);
  lastTime = now;

  // lerp vers targetVelocity
  angularVelocity += (targetVelocity - angularVelocity) * (LERP * deltaTime);
  angle += angularVelocity * deltaTime;

  // draw
  drawWheel(angle);

  // son : detecte passage d'un secteur (pointer fixed at -PI/2)
  const n = ENTRIES.length;
  if (n > 0) {
    const step = (Math.PI*2)/n;
    let pointerAngle = (-Math.PI/2 - angle) % (Math.PI*2);
    if (pointerAngle < 0) pointerAngle += Math.PI*2;
    const currentIndex = Math.floor(pointerAngle / step);
    if (currentIndex !== (animate.prevIndex ?? -1)) {
      animate.prevIndex = currentIndex;
      // play short click
      playSectorClick();
    }
  }

  // friction / slowdown applied to targetVelocity
  if (targetVelocity > 0.001) {
    if (!frictionActive) {
      frictionActive = true;
      frictionTimer = 0;
      frictionDuration = 180 + Math.random()*120;
    }
    const t = frictionTimer / frictionDuration;
    if (t < 1) {
      targetVelocity *= Math.pow(BASE_DAMPING - t * 0.03, deltaTime);
      frictionTimer += deltaTime;
    } else {
      targetVelocity *= Math.pow(0.9, deltaTime);
    }
  } else {
    frictionActive = false;
    frictionTimer = 0;
  }

  // arr√™t logique et affichage du r√©sultat
  if (Math.abs(angularVelocity) <= 0.001 && Math.abs(targetVelocity) <= 0.001) {
    angularVelocity = 0; targetVelocity = 0;
    if (hasBeenSpun && !showedResult) {
      showedResult = true;
      const idx = getSelectedIndex(angle);
      if (idx >= 0 && ENTRIES[idx] !== undefined) {
        const chosen = ENTRIES[idx];
        try { coinSound.play().catch(()=>{}); } catch(e){}
        showOverlay(chosen);
        ENTRIES.splice(idx,1);
        entryColors.splice(idx,1);
        buildStaticWheel();
        document.getElementById('countInfo').textContent = ENTRIES.length + " √©l√©ments restants";
        setTimeout(()=>{ hasBeenSpun = false; }, 300);
      }
    }
  }

  window._animFrame = requestAnimationFrame(animate);
}

/* =======================
   VISIBILITY / ONGLET
   ======================= */
let hiddenAt = null;
let wasSpinning = false;

document.addEventListener("visibilitychange", () => {
  if (document.hidden) {
    hiddenAt = performance.now();
    wasSpinning = Math.abs(angularVelocity) > 0.001 || Math.abs(targetVelocity) > 0.001;
    // pause any playing short sounds (can't control separate instances reliably), nothing to do
    cancelAnimationFrame(window._animFrame);
  } else {
    const now = performance.now();
    const elapsed = hiddenAt ? now - hiddenAt : 0;
    hiddenAt = null;

    if (wasSpinning) {
      const decay = Math.exp(-elapsed / 3000);
      angularVelocity *= decay;
      targetVelocity *= decay;

      if (Math.abs(angularVelocity) <= 0.001 && Math.abs(targetVelocity) <= 0.001 && hasBeenSpun && !showedResult) {
        angularVelocity = 0; targetVelocity = 0;
        try { coinSound.play().catch(()=>{}); } catch(e){}
        showedResult = true;
        const idx = getSelectedIndex(angle);
        if (idx >= 0 && ENTRIES[idx] !== undefined) {
          showOverlay(ENTRIES[idx]);
          ENTRIES.splice(idx,1);
          entryColors.splice(idx,1);
          buildStaticWheel();
          document.getElementById('countInfo').textContent = ENTRIES.length + " √©l√©ments restants";
          setTimeout(()=>{ hasBeenSpun = false; },300);
        }
      } else {
        lastTime = performance.now();
        window._animFrame = requestAnimationFrame(animate);
      }
    } else {
      lastTime = performance.now();
      window._animFrame = requestAnimationFrame(animate);
    }
    wasSpinning = false;
  }
});

/* =======================
   PARTAGE / CAPTURE am√©lior√©
   ======================= */
document.querySelectorAll('.share-btn[data-platform]').forEach(btn => {
  btn.addEventListener('click', async () => {
    const platform = btn.dataset.platform;
    const text = overlayText.innerText;
    const url = window.location.href;
    const message = `${text}\n${url}`;

    // cacher temporairement la barre de partage pour la capture
    const shareBar = document.getElementById('shareBar');
    const prevDisplay = shareBar.style.display;
    shareBar.style.display = 'none';

    try {
      // capture un peu plus large (plus de d√©cor)
      const rect = wheelArea.getBoundingClientRect();
      const margin = 120;
      const canvasCap = await html2canvas(document.body, {
        x: rect.left - margin,
        y: rect.top - margin,
        width: rect.width + margin*2,
        height: rect.height + margin*2,
        scale: 1.4,
        useCORS: true,
        backgroundColor: null
      });
      const imageData = canvasCap.toDataURL('image/png');

      // mobile : Web Share API
      if (navigator.share && /Android|iPhone|iPad/i.test(navigator.userAgent)) {
        try {
          const blob = await (await fetch(imageData)).blob();
          const file = new File([blob], 'resultat.png', { type: 'image/png' });
          await navigator.share({ title: 'La roue de la servitude', text, files: [file] });
          shareBar.style.display = prevDisplay;
          return;
        } catch(e){}
      }

      // desktop : liens directs
      const msg = encodeURIComponent(message);
      let shareUrl = '';
      switch (platform) {
        case 'facebook': shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}&quote=${msg}`; break;
        case 'x': shareUrl = `https://twitter.com/intent/tweet?text=${msg}`; break;
        case 'linkedin': shareUrl = `https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(url)}&title=${msg}`; break;
        case 'reddit': shareUrl = `https://www.reddit.com/submit?url=${encodeURIComponent(url)}&title=${msg}`; break;
        case 'pinterest': shareUrl = `https://pinterest.com/pin/create/button/?url=${encodeURIComponent(url)}&description=${msg}`; break;
        case 'whatsapp': shareUrl = `https://api.whatsapp.com/send?text=${msg}`; break;
        case 'telegram': shareUrl = `https://t.me/share/url?url=${encodeURIComponent(url)}&text=${msg}`; break;
        case 'messenger': shareUrl = `https://www.facebook.com/dialog/send?app_id=1111222233334444&link=${encodeURIComponent(url)}&redirect_uri=${encodeURIComponent(url)}`; break;
        case 'email': shareUrl = `mailto:?subject=${encodeURIComponent('La roue de la servitude')}&body=${msg}`; break;
        default:
          // pour Discord, Signal, YouTube, Instagram, Snapchat, TikTok
          const a = document.createElement('a');
          a.href = imageData;
          a.download = 'capture-roue.png';
          document.body.appendChild(a);
          a.click();
          a.remove();
          alert('‚úÖ Capture enregistr√©e ‚Äî ouvrez ' + platform + ' et ajoutez cette image manuellement (story, message ou post).');
          shareBar.style.display = prevDisplay;
          return;
      }

      if (shareUrl) window.open(shareUrl,'_blank','noopener,noreferrer');

    } catch(err){
      console.error('Erreur capture ou partage', err);
      alert('Erreur lors du partage.');
    } finally {
      shareBar.style.display = prevDisplay;
    }
  });
});

/* =======================
   INIT
   ======================= */
function updateBg(){
  const d = Math.sqrt(innerWidth**2 + innerHeight**2);
  document.documentElement.style.setProperty('--bg-size', `${Math.ceil(d*1.2)}px`);
  const base = Math.max(36, Math.min(Math.round(innerWidth/12), 160));
  document.documentElement.style.setProperty('--emoji-size', `${base}px`);
}
addEventListener('resize', updateBg);
updateBg();

buildStaticWheel();
document.getElementById('countInfo').textContent = ENTRIES.length + " √©l√©ments";
drawWheel(angle);
lastTime = performance.now();
window._animFrame = requestAnimationFrame(animate);

// ‚úÖ G√®re la touche Espace uniquement quand aucune fen√™tre n'est ouverte
document.addEventListener('keydown',(e)=>{
  if (e.code === 'Space') {
    e.preventDefault();
    
    // V√©rifie si une fen√™tre (overlay) est visible
    const anyModalOpen = 
      document.getElementById('overlay')?.style.display === 'flex' ||
      document.getElementById('feedbackForm')?.style.display === 'flex';

    // Si aucune fen√™tre ouverte -> autorise la rotation
    if (!anyModalOpen) {
      boostWheel();
    }
  }
});

// === D√©tection automatique de l'environnement (Netlify ou autre) ===
const isNetlifyHost = window.location.hostname.includes("netlify.app");

// Si le site n'est pas sur Netlify, on cible directement le domaine Netlify du projet
const NETLIFY_FUNCTION_URL = isNetlifyHost
  ? "/.netlify/functions/sendFeedback"
  : "https://larouedelaservitude.netlify.app/.netlify/functions/sendFeedback";

// üß© Limite anti-abus c√¥t√© client : 1 envoi par minute max
let lastFeedbackTime = 0;
  
// === üß© Fonction d‚Äôenvoi vers GitHub Discussions via Netlify ===
function sendFeedbackToGitHub(resultText, userMessage, type) {
  const now = Date.now();

  // V√©rifie s'il y a eu un envoi r√©cent
  if (now - lastFeedbackTime < 60000) { // 60 000 ms = 1 minute
    alert("Merci d‚Äôattendre une minute avant d‚Äôenvoyer un nouveau message.");
    return;
  }

  // Met √† jour la derni√®re heure d'envoi
  lastFeedbackTime = now;

  // Envoi normal
  console.log("üì° Envoi du feedback vers :", NETLIFY_FUNCTION_URL);
  
  fetch(NETLIFY_FUNCTION_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ resultText, userMessage, type })
  })
    .then(r => r.json())
    .then(data => {
      alert("‚úÖ Merci ! Votre retour a √©t√© envoy√©.");
      if (data.url) window.open(data.url, "_blank");
    })
    .catch(err => {
      console.error("Erreur lors de l'envoi du feedback :", err);
      if (err && err.message) {
        alert("‚ö†Ô∏è " + err.message);
      } else {
        alert("‚ö†Ô∏è Une erreur s'est produite lors de l'envoi du message.");
      }
    });
}

  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/larouedelaservitude/service-worker.js')
        .then((registration) => {
          console.log('ServiceWorker enregistr√© avec succ√®s : ', registration.scope);
        })
        .catch((error) => {
          console.log('√âchec de l\'enregistrement du ServiceWorker : ', error);
        });
    });
  }


  
</script>
<script src="/larouedelaservitude/bills.js" defer></script>

</body>
</html>








